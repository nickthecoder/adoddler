Net=function(){this.Request=Net._createRequestObject()},Net.get=function(e){if(!e.url||!e.onsuccess)return!1;"object"==typeof e.vars?e.vars="?"+Net._serializeObject(e.vars):"string"==typeof e.vars&&e.vars.length>0&&!/\?/.test(e.vars)&&(e.vars="?"+e.vars),e.vars||(e.vars=""),e.onerror=e.onerror||Net._fnErrorDefault;try{var t=new Net;t.Request.open("GET",e.url+e.vars,!0),t._setCallback(e.onsuccess,e.onerror),e.responseType&&(t.Request.responseType=e.responseType),t.Request.send("")}catch(r){return e.onerror("initialization"),!1}return!0},Net.post=function(e){if(!e.url||!e.onsuccess)return!1;"object"==typeof e.vars&&(e.vars=Net._serializeObject(e.vars)),e.vars||(e.vars=""),e.onerror=e.onerror||Net._fnErrorDefault;try{var t=new Net;t.Request.open("POST",e.url,!0),t._setCallback(e.onsuccess,e.onerror),e.responseType&&(t.Request.responseType=e.responseType),t.Request.setRequestHeader("Method","POST "+e.url+" HTTP/1.1"),t.Request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.Request.send(e.vars)}catch(r){return e.onerror("initialization"),!1}return!0},Net._fnErrorDefault=function(e,t){switch(e){case"timeout":alert("XMLHTTP timeout.");break;case"initialization":alert("XMLHTTP initialization failure.");break;default:alert("XMLHTTP error: ["+t.status+"] "+t.statusText)}},Net._serializeObject=function(e){var t=[];for(var r in e)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},Net.prototype._setCallback=function(e,t){this.Request.onreadystatechange=function(r){return function(){if(4==r.Request.readyState){window.clearTimeout(r.timeout);try{void 0===r.Request.status||0===r.Request.status||r.Request.status>=200&&r.Request.status<300||304==r.Request.status?e(r.Request):t("other",r.Request)}catch(s){t("other",r.Request)}}}}(this),this.timeout=window.setTimeout(function(e){return function(){e.Request.onreadystatechange=function(){},e.Request=null,t("timeout")}}(this),2e4)},Net._createRequestObject=function(){var e;if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=null}}return e};
